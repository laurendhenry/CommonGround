<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CommonGround - Empowering Farmers, Protecting Communities</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            overflow-x: hidden;
            scroll-behavior: smooth;
            background: #fafafa;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1.2rem 5%;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.05);
        }

        nav .nav-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d5016;
        }

        .logo-sunflower {
            width: 40px;
            height: 40px;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        nav a {
            color: #333;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            position: relative;
        }

        nav a:hover {
            color: #4a7c2c;
        }

        .auth-buttons {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.6rem 1.5rem;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .btn-login {
            background: transparent;
            color: #4a7c2c;
            border: 2px solid #4a7c2c;
        }

        .btn-login:hover {
            background: #4a7c2c;
            color: white;
        }

        .btn-signup {
            background: #4a7c2c;
            color: white;
        }

        .btn-signup:hover {
            background: #3a6322;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 124, 44, 0.3);
        }

        /* Sections */
        section {
            min-height: 100vh;
            padding: 120px 5%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .section-content {
            max-width: 1200px;
            width: 100%;
        }

        /* Hero Section */
        #home {
            background: linear-gradient(to bottom, #f8faf6, #ffffff);
            position: relative;
        }

        .hero-content {
            text-align: center;
        }

        .hero-sunflower {
            width: 120px;
            height: 120px;
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 4.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            color: #1a1a1a;
            line-height: 1.1;
        }

        .brand-name {
            font-weight: 700;
        }

        .tagline {
            font-size: 1.5rem;
            color: #666;
            margin-bottom: 3rem;
            font-weight: 400;
        }

        .hero-description {
            font-size: 1.2rem;
            color: #555;
            max-width: 800px;
            margin: 0 auto 3rem;
            line-height: 1.8;
        }

        .cta-buttons {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
        }

        .btn-large {
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            border-radius: 10px;
        }

        /* About Section */
        #about {
            background: white;
        }

        h2 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 2rem;
            color: #2d5016;
        }

        .section-description {
            color: #666;
            font-size: 1.2rem;
            line-height: 1.8;
            max-width: 900px;
            margin-bottom: 3rem;
        }

        .about-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .feature-card {
            background: #f8faf6;
            border-radius: 12px;
            padding: 2.5rem;
            transition: all 0.3s ease;
            border: 1px solid #e8ebe6;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1.5rem;
        }

        .feature-card h3 {
            color: #2d5016;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .feature-card p {
            color: #666;
            line-height: 1.7;
        }

        /* Dashboard Section */
        #dashboard {
            background: linear-gradient(to bottom, #f8faf6, #ffffff);
            min-height: auto;
            align-items: flex-start;
        }
        
        #dashboard .section-content {
            max-width: 1200px;
            width: 100%;
        }

        .dashboard-preview {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 3rem;
        }

        .dashboard-card {
            background: white;
            border: 2px solid #e8ebe6;
            border-radius: 12px;
            padding: 2.5rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        .dashboard-card h3 {
            color: #2d5016;
            font-size: 1.6rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .dashboard-card ul {
            list-style: none;
            color: #555;
        }

        .dashboard-card li {
            padding: 0.8rem 0;
            border-bottom: 1px solid #f0f0f0;
            font-size: 1rem;
        }

        .dashboard-card li:last-child {
            border-bottom: none;
        }

        .dashboard-card li:before {
            content: '‚úì';
            color: #5a9c34;
            margin-right: 1rem;
            font-weight: bold;
        }

        /* Predictions Section */
        #predictions {
            background: white;
        }

        .predictions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.2rem;
            margin-top: 3rem;
        }

        .prediction-item {
            background: #f8faf6;
            border-left: 4px solid #5a9c34;
            padding: 1.3rem 1.5rem;
            border-radius: 8px;
            color: #333;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .prediction-item:hover {
            background: #eef3e9;
            transform: translateX(5px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        /* Regional Insights Section */
        #regional {
            background: linear-gradient(to bottom, #f8faf6, #ffffff);
            padding: 120px 5% 80px 5%;
        }

        .regional-container {
            display: flex;
            gap: 2rem;
            margin-top: 3rem;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }

        #map {
            flex: 1;
            height: 600px;
            border-radius: 12px;
            border: 2px solid #e8ebe6;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        .map-controls {
            width: 280px;
            background: white;
            border-radius: 12px;
            padding: 2rem;
            border: 2px solid #e8ebe6;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .map-controls h3 {
            color: #2d5016;
            font-size: 1.4rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .map-controls p {
            color: #666;
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .map-feature {
            padding: 1rem 1.5rem;
            background: #f8faf6;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .map-feature:hover {
            background: #eef3e9;
            border-color: #5a9c34;
            transform: translateX(5px);
        }

        .map-feature.active {
            background: #5a9c34;
            border-color: #5a9c34;
        }

        .map-feature.active h4 {
            color: white;
        }

        .map-feature-icon {
            font-size: 2rem;
        }

        .map-feature h4 {
            color: #2d5016;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
        }

        /* Partners Section */
        #partners {
            background: white;
        }

        .partners-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .partner-card {
            background: #f8faf6;
            border-radius: 12px;
            padding: 3rem;
            border: 1px solid #e8ebe6;
            transition: all 0.3s ease;
        }

        .partner-card:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            transform: translateY(-5px);
        }

        .partner-card h3 {
            color: #2d5016;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .partner-card p {
            color: #666;
            line-height: 1.7;
            margin-bottom: 2rem;
        }

        .testimonial {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #5a9c34;
            font-style: italic;
            color: #555;
        }

        /* Contact Section */
        #contact {
            background: linear-gradient(to bottom, #f8faf6, #ffffff);
            padding-bottom: 150px;
        }

        .contact-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            margin-top: 3rem;
        }

        .team-member {
            background: white;
            border-radius: 12px;
            padding: 3rem;
            border: 2px solid #e8ebe6;
            transition: all 0.3s ease;
        }

        .team-member:hover {
            border-color: #5a9c34;
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        }

        .team-member h3 {
            color: #2d5016;
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .team-member .major {
            color: #4a7c2c;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .team-member .specialization {
            color: #888;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .team-member .email {
            color: #4a7c2c;
            font-size: 1rem;
            margin-top: 1rem;
            display: inline-block;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .team-member .email:hover {
            color: #2d5016;
            text-decoration: underline;
        }

        .fun-fact {
            background: #eef3e9;
            padding: 2rem;
            border-radius: 12px;
            margin-top: 3rem;
            color: #555;
            text-align: center;
            font-style: italic;
            border-left: 4px solid #5a9c34;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.8rem;
            }

            h2 {
                font-size: 2.2rem;
            }

            nav ul {
                display: none;
            }

            .contact-grid,
            .regional-container {
                grid-template-columns: 1fr;
            }

            .regional-container {
                flex-direction: column;
            }

            .map-controls {
                width: 100%;
            }

            section {
                padding: 100px 5%;
            }
        }

        /* Scroll indicator */
        .scroll-indicator {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            color: #999;
            font-size: 0.9rem;
            text-align: center;
        }

        .scroll-indicator::after {
            content: '‚Üì';
            display: block;
            margin-top: 0.5rem;
            font-size: 1.5rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(10px); }
        }

        /* Live Sensor Feed Styles */
        .sensor-feeds-container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-top: 3rem;
        }

        .sensor-feed-card {
            background: white;
            border: 2px solid #e8ebe6;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .sensor-feed-card:hover {
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.08);
        }

        .feed-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .feed-name {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2d5016;
        }

        .feed-status {
            font-size: 0.85rem;
            color: #888;
        }

        .feed-value {
            font-size: 3rem;
            font-weight: 700;
            color: #4a7c2c;
            margin-bottom: 1rem;
        }

        .feed-graph {
            width: 100%;
            height: 300px;
            margin-top: 1rem;
        }
        
        #combined_chart {
            width: 100% !important;
            height: 100% !important;
        }

        .fire-status-container {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .fire-indicator {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .fire-indicator.safe {
            background: #4CAF50;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
        }

        .fire-indicator.danger {
            background: #f44336;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4);
            animation: pulse 1.5s infinite;
        }

        .fire-status-text {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .fire-status-text.safe {
            color: #4CAF50;
        }

        .fire-status-text.danger {
            color: #f44336;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4a7c2c;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            color: #f44336;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        .current-value-item {
            text-align: center;
            padding: 1rem;
            background: #f8faf6;
            border-radius: 8px;
            border: 1px solid #e8ebe6;
        }

        .value-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .value-number {
            font-size: 2rem;
            font-weight: 700;
            color: #4a7c2c;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
</head>
<body>
    <nav>
        <div class="nav-content">
            <div class="logo">
                <svg class="logo-sunflower" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(0 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(30 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FFEB3B" transform="rotate(60 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(90 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FFEB3B" transform="rotate(120 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(150 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FFEB3B" transform="rotate(180 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(210 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FFEB3B" transform="rotate(240 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(270 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FFEB3B" transform="rotate(300 100 100)"/>
                    <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(330 100 100)"/>
                    <circle cx="100" cy="100" r="35" fill="#8B4513"/>
                    <circle cx="100" cy="100" r="28" fill="#D2691E" opacity="0.7"/>
                </svg>
                <span>CommonGround</span>
            </div>
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About CG</a></li>
                <li><a href="#dashboard">Dashboard</a></li>
                <li><a href="#predictions">Predictions</a></li>
                <li><a href="#regional">Regional Insights</a></li>
                <li><a href="#partners">For Partners</a></li>
                <li><a href="#contact">Contact Us</a></li>
            </ul>
            <div class="auth-buttons">
                <button class="btn btn-login">LOGIN</button>
                <button class="btn btn-signup">SIGN UP</button>
            </div>
        </div>
    </nav>

    <section id="home">
        <div class="section-content hero-content">
            <svg class="hero-sunflower" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(0 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(30 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FFEB3B" transform="rotate(60 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(90 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FFEB3B" transform="rotate(120 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(150 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FFEB3B" transform="rotate(180 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(210 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FFEB3B" transform="rotate(240 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(270 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FFEB3B" transform="rotate(300 100 100)"/>
                <ellipse cx="100" cy="40" rx="15" ry="35" fill="#FDD835" transform="rotate(330 100 100)"/>
                <circle cx="100" cy="100" r="35" fill="#8B4513"/>
                <circle cx="100" cy="100" r="28" fill="#D2691E" opacity="0.7"/>
            </svg>
            <h1><span class="brand-name">CommonGround</span></h1>
            <p class="tagline">Empowering Farmers, Protecting Communities</p>
            <p class="hero-description">
                Farmers collect the most valuable climate data in the world ‚Äî but it's siloed. 
                Our platform uses Claude to connect, interpret, and act on that data in real time. 
                Farmers improve practices, NGOs respond faster, and governments see risk before disaster strikes.
            </p>
            <div class="cta-buttons">
                <button class="btn btn-signup btn-large">Get Started</button>
                <button class="btn btn-login btn-large">Learn More</button>
            </div>
        </div>
        <div class="scroll-indicator">Scroll to explore</div>
    </section>

    <section id="about">
        <div class="section-content">
            <h2>What is <span class="brand-name">CommonGround</span>?</h2>
            <p class="section-description">
                <span class="brand-name">CommonGround</span> transforms isolated farm data into actionable intelligence. We connect real-time sensor data 
                with regional weather patterns, market trends, and predictive analytics to create a comprehensive 
                agricultural risk assessment platform.
            </p>
            <div class="about-grid">
                <div class="feature-card">
                    <div class="feature-icon">üåæ</div>
                    <h3>For Farmers</h3>
                    <p>Real-time monitoring of temperature, humidity, and fire risk. Get SMS alerts and personalized 
                    recommendations to protect your crops and livelihood.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ü§ù</div>
                    <h3>For NGOs</h3>
                    <p>Identify vulnerable populations and respond faster to agricultural crises with priority intervention 
                    maps and resource allocation recommendations.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üèõÔ∏è</div>
                    <h3>For Governments</h3>
                    <p>Predictive risk assessments, regional crop yield forecasts, and disaster heat maps to see risk 
                    before disaster strikes.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="dashboard">
        <div class="section-content">
            <h2>Personal Farmer Dashboard</h2>
            <p class="section-description">
                Your command center for real-time farm monitoring and insights.
            </p>
            <div class="sensor-feeds-container">
                <!-- Combined Sensor Graph -->
                <div class="sensor-feed-card">
                    <div class="feed-header">
                        <div class="feed-name">üìä Live Sensor Data</div>
                        <div class="feed-status" id="combined_status">Loading...</div>
                    </div>
                    <div style="width: 100%; height: 300px; position: relative;">
                        <canvas id="combined_chart"></canvas>
                    </div>
                </div>

                <!-- Individual Current Values -->
                <div class="sensor-feed-card">
                    <div class="feed-header">
                        <div class="feed-name">üå°Ô∏è Current Values</div>
                        <div class="feed-status" id="values_status">Loading...</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                        <div class="current-value-item">
                            <div class="value-label">Regional Temperature</div>
                            <div class="value-number" id="api_temp_value">--¬∞C</div>
                        </div>
                        <div class="current-value-item">
                            <div class="value-label">Regional Humidity</div>
                            <div class="value-number" id="api_humidity_value">--%</div>
                        </div>
                        <div class="current-value-item">
                            <div class="value-label">Local Farm Temperature</div>
                            <div class="value-number" id="temp_value">--¬∞C</div>
                        </div>
                        <div class="current-value-item">
                            <div class="value-label">Local Farm Humidity</div>
                            <div class="value-number" id="humidity_value">--%</div>
                        </div>
                    </div>
                </div>

                <!-- Fire Detection Feed -->
                <div class="sensor-feed-card">
                    <div class="feed-header">
                        <div class="feed-name">Fire Detection</div>
                        <div class="feed-status" id="fire_status">Loading...</div>
                    </div>
                    <div class="fire-status-container">
                        <div class="fire-indicator safe" id="fire_indicator">
                            ‚úì
                        </div>
                        <div class="fire-status-text safe" id="fire_status_text">
                            Safe
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="predictions">
        <div class="section-content">
            <h2>Agricultural Risk & Food Security Alerts</h2>
            <p class="section-description">
                Advanced predictions that go beyond what weather apps can tell you.
            </p>
            <div class="predictions-grid">
                <div class="prediction-item">Crop Stress Index</div>
                <div class="prediction-item">Irrigation Recommendations</div>
                <div class="prediction-item">Yield Prediction</div>
                <div class="prediction-item">Pest/Disease Risk Alerts</div>
                <div class="prediction-item">Regional Crop Failure Probability</div>
                <div class="prediction-item">Fire Hazard Zones</div>
                <div class="prediction-item">Vulnerable Population Estimates</div>
                <div class="prediction-item">Priority Intervention Map</div>
                <div class="prediction-item">State/Regional Crop Yield Forecast</div>
                <div class="prediction-item">Disaster Risk Heat Map</div>
                <div class="prediction-item">Resource Allocation Recommendation</div>
                <div class="prediction-item">Climate Resilience Metrics</div>
            </div>
        </div>
    </section>

    <section id="regional">
        <div class="section-content">
            <h2>Regional Insights</h2>
            <p class="section-description">
                Interactive maps showing real-time fire and earthquake hazards across California.
            </p>
            <div class="regional-container">
                <div id="map"></div>
                <div class="map-controls">
                    <h3>Select Data Layer</h3>
                    <div class="map-feature" data-layer="fires">
                        <div class="map-feature-icon"></div>
                        <h4>Forest Fires</h4>
                    </div>
                    <div class="map-feature" data-layer="earthquakes">
                        <div class="map-feature-icon"></div>
                        <h4>Earthquakes</h4>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="partners">
        <div class="section-content">
            <h2>For Partners</h2>
            <div class="partners-grid">
                <div class="partner-card">
                    <h3>For Businesses</h3>
                    <p>Access comprehensive risk assessment reports to make informed decisions about agricultural investments, 
                    supply chain management, and market opportunities. Minimize losses and maximize efficiency.</p>
                    <div class="testimonial">
                        "<span class="brand-name">CommonGround</span>'s predictive analytics helped us reduce crop loss by 40% and optimize our supply chain."
                    </div>
                </div>
                <div class="partner-card">
                    <h3>For NGOs</h3>
                    <p>Leverage real-time data to identify communities at risk, allocate resources effectively, and respond 
                    to agricultural crises before they escalate. Make every dollar count.</p>
                    <div class="testimonial">
                        "The priority intervention maps allowed us to reach vulnerable farmers weeks before disaster struck."
                    </div>
                </div>
                <div class="partner-card">
                    <h3>For Governments</h3>
                    <p>Comprehensive regional forecasts, disaster risk assessments, and climate resilience metrics to inform 
                    policy decisions and protect citizens. See the full picture.</p>
                    <div class="testimonial">
                        "<span class="brand-name">CommonGround</span>'s state-wide yield forecasts transformed how we approach agricultural policy and emergency response."
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="contact">
        <div class="section-content">
            <h2>Contact Us</h2>
            <div class="contact-grid">
                <div class="team-member">
                    <h3>Sagarika Srinivasan</h3>
                    <p class="major">Computer Science</p>
                    <p class="specialization">Human-Computer Interaction and Artificial Intelligence<br>Public Policy</p>
                    <a href="mailto:ssrinivasan358@gatech.edu" class="email">ssrinivasan358@gatech.edu</a>
                </div>
                <div class="team-member">
                    <h3>Lauren Henry</h3>
                    <p class="major">Computer Science</p>
                    <p class="specialization">Information Networks and Devices<br>Global Engagement</p>
                    <a href="mailto:lhenry38@gatech.edu" class="email">lhenry38@gatech.edu</a>
                </div>
            </div>
            <div class="fun-fact">
                Fun fact! We respond to emails faster than our own texts ;)<br>
                Feel free to hit us up with questions, project ideas, a job, you name it!
            </div>
        </div>
    </section>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>

    <!-- Load config (contains API keys) -->
    <script src="config.js"></script>

    <script>

        // Chart instance storage
        let combinedChart = null;
        const feedData = {};

        // Initialize Adafruit IO integration
        function initAdafruitIO() {
            if (!ADAFRUIT_CONFIG || !ADAFRUIT_CONFIG.key || ADAFRUIT_CONFIG.key === 'YOUR_API_KEY_HERE') {
                console.log('Please create website/config.js with your Adafruit IO API key (see config.js.example)');
                showApiKeyError();
                return;
            }

            // Initialize combined chart
            initializeCombinedChart();
            
            // Start fetching data
            fetchAllFeeds();
            
            // Set up polling
            setInterval(fetchAllFeeds, 15000); // Poll every 30 seconds
        }

        // Show API key error
        function showApiKeyError() {
            const statusElements = ['combined_status', 'values_status', 'fire_status'];
            statusElements.forEach(statusId => {
                const statusEl = document.getElementById(statusId);
                if (statusEl) {
                    statusEl.textContent = 'Config file required';
                    statusEl.style.color = '#f44336';
                }
            });
        }

        // Initialize combined Chart.js instance
        function initializeCombinedChart() {
            const ctx = document.getElementById('combined_chart');
            if (ctx) {
                combinedChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            {
                                label: 'Regional Temperature (¬∞C)',
                                data: [],
                                borderColor: '#e74c3c',
                                backgroundColor: 'rgba(231, 76, 60, 0.1)',
                                borderWidth: 2,
                                fill: false,
                                tension: 0.4
                            },
                            {
                                label: 'Regional Humidity (%)',
                                data: [],
                                borderColor: '#3498db',
                                backgroundColor: 'rgba(52, 152, 219, 0.1)',
                                borderWidth: 2,
                                fill: false,
                                tension: 0.4
                            },
                            {
                                label: 'Local Temperature (¬∞C)',
                                data: [],
                                borderColor: '#f39c12',
                                backgroundColor: 'rgba(243, 156, 18, 0.1)',
                                borderWidth: 2,
                                fill: false,
                                tension: 0.4
                            },
                            {
                                label: 'Local Humidity (%)',
                                data: [],
                                borderColor: '#27ae60',
                                backgroundColor: 'rgba(39, 174, 96, 0.1)',
                                borderWidth: 2,
                                fill: false,
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: false,
                                grid: {
                                    color: '#e8ebe6'
                                }
                            },
                            x: {
                                grid: {
                                    color: '#e8ebe6'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            }
                        }
                    }
                });
            }
        }

        // Fetch data from all feeds
        async function fetchAllFeeds() {
            let successCount = 0;
            const totalFeeds = ADAFRUIT_CONFIG.feeds.length;
            
            for (const feed of ADAFRUIT_CONFIG.feeds) {
                try {
                    await fetchFeedData(feed);
                    successCount++;
                } catch (error) {
                    console.error(`Error fetching ${feed}:`, error);
                }
            }
            
            // Update status based on success rate
            if (successCount === totalFeeds) {
                updateCombinedStatus('Online', '#4CAF50');
            } else if (successCount > 0) {
                updateCombinedStatus('Partial', '#f39c12');
            } else {
                updateCombinedStatus('Offline', '#f44336');
            }
        }

        // Fetch data from a specific feed
        async function fetchFeedData(feedName) {
            const url = `${ADAFRUIT_CONFIG.baseUrl}/${ADAFRUIT_CONFIG.username}/feeds/${feedName}/data/last`;
            
            try {
                const response = await fetch(url, {
                    headers: {
                        'X-AIO-Key': ADAFRUIT_CONFIG.key
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();
                console.log(`Fetched ${feedName}:`, data);
                updateFeedDisplay(feedName, data);
                
            } catch (error) {
                console.error(`Failed to fetch ${feedName}:`, error);
            }
        }

        // Update feed display with new data
        function updateFeedDisplay(feedName, data) {
            const isFireSensor = feedName === 'fire';
            const value = isFireSensor ? data.value : parseFloat(data.value);
            const timestamp = new Date(data.created_at);
            
            // Store data for charts
            if (!feedData[feedName]) {
                feedData[feedName] = [];
            }
            
            feedData[feedName].push({
                value: value,
                timestamp: timestamp
            });
            
            // Keep only last 20 data points
            if (feedData[feedName].length > 20) {
                feedData[feedName] = feedData[feedName].slice(-20);
            }

            // Handle fire sensor separately
            if (isFireSensor) {
                updateFireDisplay(value);
                return;
            }

            // Update current value display for other sensors
            // Map feed names to display element IDs
            const feedDisplayMap = {
                'api-temp': 'api_temp_value',
                'api-humidity': 'api_humidity_value',
                'temperature': 'temp_value',
                'humidity': 'humidity_value'
            };
            
            const displayElementId = feedDisplayMap[feedName];
            const valueEl = displayElementId ? document.getElementById(displayElementId) : null;
            
            if (valueEl) {
                const unit = (feedName.includes('temp') || feedName === 'temperature') ? '¬∞C' : '%';
                valueEl.textContent = `${value.toFixed(1)}${unit}`;
            }

            // Update combined chart
            updateCombinedChart();
        }

        // Update fire detection display
        function updateFireDisplay(value) {
            const indicator = document.getElementById('fire_indicator');
            const statusText = document.getElementById('fire_status_text');
            const statusEl = document.getElementById('fire_status');
            
            console.log('Fire value:', value, 'Type:', typeof value, 'String compare:', value === "1", 'Number compare:', value === 1);
            
            // Handle both string "1" and number 1, or "0" and 0
            const fireDetected = value === 1 || value === "1" || value === true;
            
            if (fireDetected) {
                // Fire detected
                indicator.className = 'fire-indicator danger';
                indicator.textContent = '!';
                statusText.className = 'fire-status-text danger';
                statusText.textContent = 'FIRE DETECTED';
                if (statusEl) statusEl.textContent = 'Alert';
                if (statusEl) statusEl.style.color = '#f44336';
            } else {
                // Safe
                indicator.className = 'fire-indicator safe';
                indicator.textContent = '‚úì';
                statusText.className = 'fire-status-text safe';
                statusText.textContent = 'Safe';
                if (statusEl) statusEl.textContent = 'Online';
                if (statusEl) statusEl.style.color = '#4CAF50';
            }
        }

        // Update combined chart with new data
        function updateCombinedChart() {
            if (!combinedChart) return;

            // Map actual feed names to dataset indices
            const feedToDatasetMap = {
                'api-temp': 0,        // Dataset 0: API Temperature
                'api-humidity': 1,    // Dataset 1: API Humidity
                'temperature': 2,     // Dataset 2: Local Temperature
                'humidity': 3         // Dataset 3: Local Humidity
            };
            
            const datasets = combinedChart.data.datasets;
            
            // Update each dataset based on available feed data
            Object.keys(feedToDatasetMap).forEach(feedName => {
                const datasetIndex = feedToDatasetMap[feedName];
                if (feedData[feedName] && feedData[feedName].length > 0) {
                    datasets[datasetIndex].data = feedData[feedName].map(d => d.value);
                    datasets[datasetIndex].label = feedName.replace('-', ' ').replace('api', 'API');
                }
            });
            
            // Update labels (use timestamps from first available feed)
            const allFeeds = ['api-temp', 'api-humidity', 'temperature', 'humidity'];
            const firstFeed = allFeeds.find(feed => feedData[feed] && feedData[feed].length > 0);
            if (firstFeed && feedData[firstFeed]) {
                combinedChart.data.labels = feedData[firstFeed].map(d => d.timestamp.toLocaleTimeString());
            }
            
            combinedChart.update();
        }

        // Update combined status
        function updateCombinedStatus(status, color) {
            const statusEl = document.getElementById('combined_status');
            const valuesStatusEl = document.getElementById('values_status');
            
            if (statusEl) {
                statusEl.textContent = status;
                statusEl.style.color = color;
            }
            if (valuesStatusEl) {
                valuesStatusEl.textContent = status;
                valuesStatusEl.style.color = color;
            }
        }

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            });
        });

        window.addEventListener('scroll', () => {
            let current = '';
            document.querySelectorAll('section').forEach(section => {
                if (pageYOffset >= section.offsetTop - 200) {
                    current = section.getAttribute('id');
                }
            });
            document.querySelectorAll('nav a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').slice(1) === current) {
                    link.classList.add('active');
                }
            });
        });

        document.querySelectorAll('.btn').forEach(button => {
            button.addEventListener('click', function() {
                if (this.textContent === 'LOGIN' || this.textContent === 'SIGN UP') {
                    alert('Authentication system coming soon!');
                } else if (this.textContent === 'Get Started') {
                    document.querySelector('#dashboard').scrollIntoView({ behavior: 'smooth' });
                } else if (this.textContent === 'Learn More') {
                    document.querySelector('#about').scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        const map = L.map('map', { zoomControl: true }).setView([37.5, -119.5], 6);
        L.tileLayer('https://tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: '¬© OpenStreetMap contributors',
        }).addTo(map);

        fetch('https://raw.githubusercontent.com/codeforamerica/click_that_hood/master/public/data/california-counties.geojson')
            .then(res => res.json())
            .then(geo => {
                L.geoJSON(geo, { color: '#5a9c34', weight: 2, fillOpacity: 0 }).addTo(map);
            });

        let currentLayer = null;

        function clearMap() {
            if (currentLayer) { 
                map.removeLayer(currentLayer); 
                currentLayer = null; 
            }
        }

        function showFires() {
            clearMap();
            fetch('fireAndQuakes/cal_fire_heatmap.json')
                .then(res => res.json())
                .then(data => {
                    currentLayer = L.geoJSON(data, {
                        style: feature => {
                            const score = feature.properties.fire_hazard_score;
                            return {
                                color: '#d32f2f',
                                fillColor: score > 0.7 ? '#d32f2f' : score > 0.4 ? '#ff9800' : '#ffeb3b',
                                weight: 1,
                                fillOpacity: 0.6
                            };
                        },
                        onEachFeature: (feature, layer) => {
                            layer.bindPopup(`Fire hazard: ${feature.properties.fire_hazard_class}<br>Score: ${feature.properties.fire_hazard_score}`);
                        }
                    }).addTo(map);
                });
        }

        function showEarthquakes() {
            clearMap();
            fetch('fireAndQuakes/seismic_hazards.json')
                .then(res => res.json())
                .then(data => {
                    currentLayer = L.geoJSON(data, {
                        style: feature => {
                            const score = feature.properties.seismic_hazard_score;
                            return {
                                color: score > 0.7 ? '#d32f2f' : score > 0.4 ? '#ff9800' : '#ffeb3b',
                                weight: 2,
                                fillOpacity: 0.4
                            };
                        },
                        onEachFeature: (feature, layer) => {
                            layer.bindPopup(`${feature.properties.location_name}<br>Seismic hazard: ${feature.properties.seismic_hazard_class}<br>Score: ${feature.properties.seismic_hazard_score}`);
                        }
                    }).addTo(map);
                });
        }

        document.querySelectorAll('.map-feature').forEach(feature => {
            feature.addEventListener('click', function() {
                document.querySelectorAll('.map-feature').forEach(f => f.classList.remove('active'));
                this.classList.add('active');
                const layer = this.getAttribute('data-layer');
                if (layer === 'fires') showFires();
                if (layer === 'earthquakes') showEarthquakes();
            });
        });

        showFires();
        document.querySelector('[data-layer="fires"]').classList.add('active');

        // Initialize Adafruit IO when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initAdafruitIO();
        });
    </script>
</body>
</html>